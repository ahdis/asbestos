<TestScript xmlns="http://hl7.org/fhir">
    <modifierExtension url="urn:module">
        <extension url="urn:fixture-in">
            <valueString value="theResource"/>
        </extension>
        <extension url="urn:variable-in">
            <valueString value="validationServer"/>
        </extension>
        <extension url="urn:variable-in">
            <valueString value="resourceType"/>
        </extension>
        <extension url="urn:variable-in">
            <valueString value="profile"/>
        </extension>
    </modifierExtension>

    <id value="StructureDefinitionValidationMain"/>
    <name value="StructureDefinitionValidationMain"/>
    <description value="This TestScript has the following parameters: 1) Validation server is the fhir base, 2) resourceType is the resource type to validate, 3) profile is the canonical URL obtained from the IHE FHIR-based IG Message Semantics page, suffixed with an optional version number specified as #n.n.n where n is an integer equal to or greater than 0. If version is omitted, it implies latest version or the version automatically selected by the validation server. When this script is imported as a module, the variables with defaultValues are overridden with the input parameter extensions."/>

    <variable>
        <name value="validationServer"/>
        <defaultValue value="@inspectorModeTsModuleCallValuePlaceholder"/>
    </variable>
    <variable>
        <name value="resourceType"/>
        <defaultValue value="@inspectorModeTsModuleCallValuePlaceholder"/>
    </variable>
    <variable>
        <name value="profile"/>
        <defaultValue value="@inspectorModeTsModuleCallValuePlaceholder"/>
    </variable>


    <test>
        <description value="Structure definition based resource validation."/>
        <action>
            <operation>
                <description value="Validation call."/>
                <label value="validate"/>
                <type>
                    <system value="https://hl7.org/fhir/codesystem-testscript-operation-codes.html"/>
                    <code value="validate"/>
                </type>
                <url value="${validationServer}/${resourceType}/$validate?profile=${profile}"/>
                <method value="post"/>
                <sourceId value="theResource"/>
                <responseId value="validationResponse"/>
            </operation>
        </action>
    </test>
</TestScript>
